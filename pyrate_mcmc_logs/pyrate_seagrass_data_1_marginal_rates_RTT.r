# 1 files combined:
# 	/home/eeb177-student/Desktop/final_project_eeb177/pyrate_mcmc_logs/pyrate_seagrass_data_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/final_project_eeb177/pyrate_mcmc_logs/pyrate_seagrass_data_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.0274094050891, 0.0274094050891,0.027511155478,0.0287491791352,0.0294000084983,0.0300918300701,0.0300918300701,0.0300918300701,0.0302538615672,0.0302538615672,0.0294000084983,0.0294000084983,0.0294000084983,0.0294000084983,0.0294000084983,0.0294000084983,0.029491655542,0.0297423492932,0.0297423492932,0.0298218235289,0.0300918300701,0.0300918300701,0.0300918300701,0.0300918300701,0.0300918300701,0.0300918300701,0.0301051869413,0.0301051869413,0.0300918300701,0.0300918300701,0.0300918300701,0.0300918300701,0.0300918300701,0.0301051869413,0.0301051869413,0.0301051869413,0.0302538615672,0.0302538615672,0.0302538615672,0.0302538615672,0.030157750978,0.030157750978,0.0302538615672,0.0302538615672,0.0307979084936,0.0307979084936,0.0307979084936,0.0309153242059,0.0309153242059,0.0302538615672,0.030157750978,0.0302538615672,0.030157750978,0.0301051869413,0.030157750978,0.0302538615672,0.0302538615672,0.0302538615672,0.0301051869413,0.0301051869413,0.0302538615672,0.0301051869413,0.0302538615672,0.0302538615672,0.0302538615672,0.0301051869413,0.0301051869413,0.0297423492932,0.0298218235289,0.0297423492932,0.0297423492932,0.0298218235289,0.0298218235289,0.0298218235289,0.0298218235289,0.0294763105708,0.0294330573993,0.0294330573993,0.0294330573993,0.0294330573993,0.0294330573993,0.0294763105708,0.0294763105708,0.0294330573993,0.0294763105708,0.0294330573993,0.0294763105708,0.0294330573993,0.0294763105708,0.0294330573993,0.0294330573993,0.0288936215529,0.0290915740959,0.0290502665451,0.0290502665451,0.0288936215529,0.0298218235289,0.0297423492932,0.0298218235289,0.0298648274455,0.0294330573993,0.0294330573993,0.0294330573993,0.0289016516443,0.0289016516443,0.0283797292166,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891,0.0282361702685,0.0282361702685,0.0283797292166,0.0283797292166,0.0274478587034,0.0274478587034,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891,0.0274094050891)
L_hpd_M95=c(0.611693972649, 0.611693972649,0.0692170207716,0.0684680603581,0.0684338166077,0.0677541189504,0.0669706636976,0.0663956347427,0.0663956347427,0.0663340164786,0.0652300014081,0.0651291909541,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.0651291909541,0.0651291909541,0.0651291909541,0.0651291909541,0.0651291909541,0.0649939413813,0.0649939413813,0.0648604756798,0.0647912310945,0.0647912310945,0.0647912310945,0.0647912310945,0.0646717341354,0.0646717341354,0.0646378128875,0.0646378128875,0.0646378128875,0.0646378128875,0.0646378128875,0.0646378128875,0.0646717341354,0.0646717341354,0.0646717341354,0.0646717341354,0.0646717341354,0.0646717341354,0.0646717341354,0.0646717341354,0.0651291909541,0.0651291909541,0.065088464477,0.0651291909541,0.0651291909541,0.0646378128875,0.0646717341354,0.0646717341354,0.0646717341354,0.0646378128875,0.0646717341354,0.0649108583308,0.0649108583308,0.0649108583308,0.0647912310945,0.0647912310945,0.0649108583308,0.0648604756798,0.0649939413813,0.0649939413813,0.0649939413813,0.0648927124702,0.065088464477,0.0649108583308,0.0649108583308,0.0649108583308,0.0649108583308,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.0649108583308,0.0649939413813,0.0649939413813,0.0649939413813,0.0649939413813,0.0649939413813,0.065088464477,0.065088464477,0.0649939413813,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.0647912310945,0.065088464477,0.065088464477,0.065088464477,0.065088464477,0.0662831954446,0.0664111330457,0.0665891015743,0.0669275478883,0.0666747622268,0.0671581070849,0.0674676523197,0.0673985893207,0.0677895576311,0.0680294886883,0.0675849732175,0.0676847093798,0.0679518031849,0.0679518031849,0.0679518031849,0.0679518031849,0.0680294886883,0.0692259922314,0.0696196023415,0.0700311514743,0.0700311514743,0.0692259922314,0.0692259922314,0.0692170207716,0.0692259922314,0.0696196023415,0.0699242047487,0.0700311514743)
M_hpd_m95=c(0.216876746425, 0.216876746425,0.00834619194507,0.00579801599047,0.0149658410688,0.0176734791879,0.0186702169214,0.0190589785567,0.0193261783725,0.0193261783725,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0181093156423,0.0183143419685,0.0183143419685,0.0183143419685,0.0186206774205,0.0186206774205,0.0186206774205,0.0184119243921,0.0186702169214,0.0189447613303,0.0186702169214,0.0193261783725,0.0193261783725,0.0193261783725,0.0193261783725,0.0193261783725,0.0193261783725,0.0193261783725,0.0193261783725,0.0189447613303,0.0196550321301,0.0186206774205,0.0189447613303,0.0186206774205,0.0189447613303,0.0183143419685,0.0184119243921,0.0184119243921,0.0184119243921,0.0184119243921,0.0183143419685,0.0181093156423,0.0181093156423,0.0181093156423,0.0183143419685,0.0184119243921,0.0184119243921,0.0184119243921,0.0184946311637,0.0184119243921,0.0184119243921,0.0184119243921,0.0181093156423,0.0181093156423,0.0181093156423,0.0179207558016,0.0181093156423,0.0181093156423,0.0177994240861,0.0176734791879,0.0162376701945,0.0145734930967,0.0138158136748,0.0139773240817,0.0138158136748,0.0138158136748,0.0137339041759,0.0137339041759,0.0135482781338,0.0137339041759,0.0137638564955,0.0137339041759,0.0122595493698,0.01125789208,0.0108527079868,0.0108527079868,0.0108527079868,0.0108527079868,0.0106548417455,0.0106548417455,0.0101190782821,0.0102257336289,0.0102257336289,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0101190782821,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289,0.0102257336289)
M_hpd_M95=c(1.7638367094, 1.7638367094,0.801347627059,0.490209720507,0.0573947469791,0.0553356908929,0.0553356908929,0.0553356908929,0.0553356908929,0.0553356908929,0.0539255809792,0.0539255809792,0.0539255809792,0.0539255809792,0.0539255809792,0.0537840784134,0.0537840784134,0.0537738682513,0.0537738682513,0.0537738682513,0.0537840784134,0.0538210778303,0.0538210778303,0.0539255809792,0.0538210778303,0.0539255809792,0.0538210778303,0.0538210778303,0.0538210778303,0.0538210778303,0.0539255809792,0.0539255809792,0.0537738682513,0.0537097136824,0.0537002101918,0.0537097136824,0.0537097136824,0.0537738682513,0.0532025374627,0.0538210778303,0.0525490390229,0.0528155861663,0.0525490390229,0.0525490390229,0.0518493034104,0.0518493034104,0.0517857384932,0.0518132919449,0.0518493034104,0.0518493034104,0.0517857384932,0.0517857384932,0.0517857384932,0.0518493034104,0.0518493034104,0.0518493034104,0.0517857384932,0.0518493034104,0.0518132919449,0.0518132919449,0.0518132919449,0.0515075259901,0.0515075259901,0.0515075259901,0.051535970598,0.0518493034104,0.0518493034104,0.051535970598,0.0518493034104,0.0507488506333,0.0489037507714,0.0485411683712,0.0485411683712,0.0485319321544,0.0485319321544,0.0485411683712,0.0487055029528,0.0485411683712,0.0487055029528,0.0485411683712,0.0485411683712,0.0472507043036,0.0466553952453,0.0462140930137,0.046190747259,0.046190747259,0.046190747259,0.0462140930137,0.0465855671764,0.0462979331689,0.0462140930137,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689,0.0462979331689)
R_hpd_m95=c(-1.96612848381, -1.96612848381,-0.826940345516,-0.515711549114,-0.0291469945678,-0.0175475752452,-0.0134102474882,-0.0113023479319,-0.0134730788714,-0.0133672697138,-0.0113023479319,-0.0112758324953,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0115579612843,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0113023479319,-0.0115579612843,-0.0122625576992,-0.0121685476199,-0.0122625576992,-0.0122625576992,-0.0120711550731,-0.0120711550731,-0.0120711550731,-0.0115579612843,-0.0113023479319,-0.0113023479319,-0.0112758324953,-0.0112758324953,-0.0112695893884,-0.0112758324953,-0.0112758324953,-0.0112758324953,-0.0112758324953,-0.0112758324953,-0.00942478853717,-0.00942478853717,-0.00932708145917,-0.00942478853717,-0.00942478853717,-0.00875201067882,-0.00888178515962,-0.00888178515962,-0.0105605406817,-0.00932708145917,-0.00888178515962,-0.00932708145917,-0.00936415058988,-0.00942478853717,-0.0108264469199,-0.0108264469199,-0.0096800284373,-0.00936415058988,-0.00936415058988,-0.00936415058988,-0.00936415058988,-0.00936415058988,-0.00936415058988,-0.00888178515962,-0.00889950692109,-0.00889950692109,-0.00875201067882,-0.00875201067882,-0.00875201067882,-0.00875201067882,-0.00875201067882,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00883546184672,-0.00778248130872,-0.00778248130872,-0.00778248130872,-0.00788552141725,-0.00772039307044,-0.00778248130872,-0.00788552141725,-0.00796013479112,-0.00805681730777,-0.008194915603,-0.00714073613025,-0.00714073613025,-0.00883546184672,-0.00874469909498,-0.00889950692109,-0.00805681730777,-0.00889950692109,-0.00925969227888,-0.00796013479112,-0.00772039307044,-0.00925969227888,-0.00874469909498,-0.00889950692109,-0.00805681730777,-0.008194915603,-0.00805681730777,-0.00796013479112,-0.00796013479112,-0.00796013479112,-0.00805681730777,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00889950692109,-0.00918243561166,-0.00925969227888,-0.00925969227888,-0.00883546184672)
R_hpd_M95=c(0.108956100387, 0.108956100387,0.0555577958357,0.0494475777702,0.0494475777702,0.0414313270835,0.0411577659378,0.0413909678639,0.03833259729,0.038260192299,0.0394616765818,0.0394616765818,0.0393617068047,0.0392471661732,0.0392471661732,0.0392471661732,0.0391586988585,0.0384927794889,0.0389663219546,0.0389663219546,0.038260192299,0.03833259729,0.03833259729,0.0382184930085,0.038260192299,0.0384927794889,0.0381587491538,0.0381587491538,0.0381587491538,0.0381587491538,0.0381587491538,0.0381587491538,0.0381587491538,0.0384927794889,0.03833259729,0.03833259729,0.03833259729,0.03833259729,0.0381587491538,0.0381260279587,0.0381260279587,0.0381012602472,0.0379349512629,0.0381012602472,0.0394616765818,0.0394616765818,0.0394616765818,0.0390843020016,0.0389663219546,0.0396553616248,0.0396553616248,0.0396553616248,0.0381587491538,0.0394616765818,0.0396071542272,0.0394616765818,0.0394616765818,0.0394616765818,0.0384927794889,0.0384927794889,0.0396553616248,0.0396553616248,0.0396553616248,0.0396553616248,0.0396071542272,0.0396553616248,0.0396071542272,0.0396071542272,0.0396553616248,0.0395756799391,0.0395756799391,0.0396071542272,0.0396553616248,0.0396071542272,0.0395756799391,0.0395756799391,0.0400196861007,0.0400196861007,0.0396553616248,0.0396553616248,0.0398946483929,0.0400196861007,0.0405032062122,0.0415017296493,0.041750939123,0.0419882959906,0.0419882959906,0.0425149547209,0.042659391707,0.042659391707,0.042659391707,0.042659391707,0.042659391707,0.0438496789229,0.0438496789229,0.0425149547209,0.042659391707,0.042659391707,0.0439727653178,0.04373631884,0.0439727653178,0.0458475274399,0.0467948011097,0.0458475274399,0.0467948011097,0.0474994513832,0.048997612297,0.048997612297,0.0492808008815,0.0495036721334,0.0495036721334,0.0495036721334,0.0495036721334,0.0488810605321,0.0491796710544,0.0492808008815,0.0492808008815,0.0494264634331,0.0494264634331,0.0495036721334,0.0495036721334,0.0495036721334,0.0498848288877,0.050630165527)
L_mean=c(0.110695580767, 0.110695580767,0.0542154413247,0.0518913629882,0.0511320648203,0.0496656513402,0.0486884574236,0.0480675946848,0.0478694352623,0.0477631328755,0.0476825908607,0.0476588571879,0.0476489682693,0.0476331482052,0.0476375177298,0.0476376069995,0.0476158480366,0.0475435558464,0.0475409216164,0.0475328800415,0.047445324331,0.0474166362254,0.0474166362254,0.047394507728,0.0473652110898,0.0473615562042,0.0473603260726,0.0473646365944,0.0473385648222,0.0473390859747,0.0473306644606,0.0473343635791,0.0473704940291,0.0473529935061,0.0473333559657,0.0473312230302,0.0473523580878,0.0473552739603,0.0473611256017,0.0473618741668,0.0473790417422,0.0473737944552,0.0473907921592,0.0473950323018,0.0474004047984,0.0474174543235,0.0474324070354,0.0474363205034,0.047432166529,0.0473822094013,0.0473677758687,0.0473777315835,0.0473496215013,0.0473158534111,0.0472958347391,0.0472693880898,0.047230182632,0.0472101958497,0.0471655164564,0.0471598810341,0.0471282316556,0.0471039346559,0.0471026564631,0.0470908174234,0.0470939851032,0.0470800634678,0.047017455626,0.0469602235446,0.0469046603046,0.046857593444,0.046839906346,0.0468301268288,0.0467758003292,0.0467432680908,0.0467193900071,0.0467071343516,0.0466772335831,0.0466674134937,0.0466594314315,0.0466632229008,0.0466583512136,0.0466388589882,0.0466388589882,0.0466566525931,0.0466533883709,0.0466689128423,0.0466616161239,0.0466775736191,0.046685832579,0.0467120968409,0.0467200277932,0.0467384760508,0.0467742190423,0.0467874754627,0.0467838820404,0.0468911960271,0.0469438021781,0.0470461102694,0.0473224760842,0.0475252736496,0.0479375837018,0.0482091024224,0.048473838705,0.0487432490813,0.0489559983882,0.049250358893,0.049428044339,0.0494718734125,0.049479948797,0.0495437508231,0.0495411865333,0.0495411865333,0.0495713826702,0.0496589612766,0.0497817295207,0.0497931236456,0.0497931236456,0.0498307957815,0.0498307957815,0.049891702186,0.0499538409491,0.0501745138715,0.0503268735341,0.0504474936269)
M_mean=c(0.901760974973, 0.901760974973,0.210857937737,0.0877928940326,0.0414532295125,0.0357097828532,0.0344198401895,0.0340002107297,0.0337868405852,0.0337868405852,0.0336231399244,0.0336245881055,0.0336227863324,0.0336227863324,0.0336227863324,0.0336235898836,0.0336235898836,0.0336210556581,0.0336239780864,0.0336159458118,0.0336353162942,0.0336656844699,0.0336803011808,0.0337402687765,0.0338305149472,0.0339301036491,0.0340236915082,0.0341055616255,0.0341539418777,0.0342079482152,0.0342587617628,0.0342615624831,0.0342811608658,0.0342993026516,0.0342877869561,0.034283861232,0.0342716794107,0.034242922627,0.0342275232462,0.0341748572334,0.0340830239577,0.0340581138343,0.0340093732443,0.0339263103527,0.0338919157799,0.0338657660843,0.0338200081095,0.0337939665431,0.0337321172279,0.0336905921557,0.0336887376483,0.0336771319231,0.0336482413701,0.0336228276612,0.0336012501224,0.0336039440825,0.0335767228447,0.0335893408539,0.0336477615135,0.0336417154239,0.0336419444251,0.0336370137123,0.0336309287646,0.0335720212655,0.0335071859402,0.0333767194306,0.0331311969277,0.0328052089796,0.0326075102991,0.0324057101574,0.0321689941185,0.0320400891795,0.0319690365976,0.0318915134751,0.0318391700489,0.0317347612743,0.0316681884291,0.0316192331765,0.0315672207953,0.0314745347396,0.0313354642678,0.0311992104912,0.0310464609329,0.0308521371454,0.0307033055068,0.0305689041773,0.0303474736865,0.0301926302461,0.0299419057526,0.0298512223254,0.0298085312806,0.0297306499595,0.0296857105757,0.0296390044953,0.0296390044953,0.0296361856721,0.0296238242666,0.029613553965,0.029613553965,0.0296110098249,0.0296110098249,0.0296110098249,0.0296110098249,0.0296110098249,0.0296079534724,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079,0.0295980128079)
R_mean=c(-0.791065394205, -0.791065394205,-0.156642496412,-0.0359015310444,0.00967883530784,0.013955868487,0.0142686172341,0.0140673839551,0.0140825946771,0.0139762922903,0.0140594509362,0.0140342690825,0.0140261819369,0.0140103618728,0.0140147313973,0.0140140171158,0.013992258153,0.0139225001884,0.01391694353,0.0139169342297,0.0138100080368,0.0137509517556,0.0137363350447,0.0136542389515,0.0135346961426,0.0134314525551,0.0133366345644,0.0132590749689,0.0131846229445,0.0131311377595,0.0130719026978,0.0130728010959,0.0130893331633,0.0130536908545,0.0130455690096,0.0130473617982,0.0130806786772,0.0131123513334,0.0131336023554,0.0131870169334,0.0132960177844,0.013315680621,0.0133814189149,0.0134687219492,0.0135084890185,0.0135516882392,0.0136123989259,0.0136423539603,0.0137000493012,0.0136916172456,0.0136790382204,0.0137005996604,0.0137013801312,0.01369302575,0.0136945846167,0.0136654440072,0.0136534597872,0.0136208549958,0.0135177549429,0.0135181656102,0.0134862872305,0.0134669209435,0.0134717276985,0.0135187961579,0.013586799163,0.0137033440372,0.0138862586982,0.014155014565,0.0142971500055,0.0144518832866,0.0146709122275,0.0147900376493,0.0148067637316,0.0148517546156,0.0148802199582,0.0149723730773,0.015009045154,0.0150481803172,0.0150922106362,0.0151886881611,0.0153228869458,0.015439648497,0.0155923980553,0.0158045154477,0.015950082864,0.016100008665,0.0163141424373,0.0164849433729,0.0167439268264,0.0168608745155,0.0169114965126,0.0170078260913,0.0170885084666,0.0171484709674,0.0171448775452,0.017255010355,0.0173199779116,0.0174325563044,0.0177089221193,0.0179142638247,0.0183265738768,0.0185980925975,0.0188628288801,0.0191322392563,0.0193480449158,0.0196523460851,0.0198300315311,0.0198738606046,0.0198819359891,0.0199457380152,0.0199431737254,0.0199431737254,0.0199733698623,0.0200609484687,0.0201837167128,0.0201951108377,0.0201951108377,0.0202327829736,0.0202327829736,0.0202936893781,0.0203558281412,0.0205765010636,0.0207288607262,0.020849480819)
trans=0.5
age=(0:(124-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.672863369914), xlim = c(-130.2,6.2), ylab = 'Speciation rate', xlab = 'Ma',main='pyrate' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.94022038034), xlim = c(-130.2,6.2), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-2.16274133219, 0.119851710426), xlim = c(-130.2,6.2), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-130.2,6.2), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()