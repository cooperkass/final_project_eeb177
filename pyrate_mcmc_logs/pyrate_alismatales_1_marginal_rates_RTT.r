# 1 files combined:
# 	/home/eeb177-student/Desktop/final_project_eeb177/pyrate_mcmc_logs/pyrate_alismatales_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/final_project_eeb177/pyrate_mcmc_logs/pyrate_alismatales_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.0218486528629, 0.0218486528629,0.0204173755334,0.0268424694424,0.0268424694424,0.0268424694424,0.0286716681456,0.0286716681456,0.0286716681456,0.0286716681456,0.0288920072704,0.0288920072704,0.0290261896111,0.0290261896111,0.0290261896111,0.0283682374128,0.0283682374128,0.0283682374128,0.0288920072704,0.0289335366228,0.0290261896111,0.0292285979005,0.0292285979005,0.0292285979005,0.0292285979005,0.0292285979005,0.0293250414778,0.0293250414778,0.0293250414778,0.0293250414778,0.0293250414778,0.0293250414778,0.0293250414778,0.0295267861811,0.0295267861811,0.0295267861811,0.0293250414778,0.0295267861811,0.0295267861811,0.0293410648663,0.0295267861811,0.0295267861811,0.0295267861811,0.0295267861811,0.0295267861811,0.0288920072704,0.0288920072704,0.0293250414778,0.0290906873825,0.0290261896111,0.0290261896111,0.0286716681456,0.0286716681456,0.0288920072704,0.0288920072704,0.0288920072704,0.0288920072704,0.0288920072704,0.0286716681456,0.0286716681456,0.0286716681456,0.027078483582,0.0271013271876,0.026682349317,0.027078483582,0.0254172702251,0.026786124225,0.026682349317,0.026682349317,0.0250075568249,0.0226004135133,0.0222237442123,0.0224314432878,0.0224314432878,0.0192344262363,0.0193112316289,0.0193112316289,0.0193112316289,0.0193112316289,0.0192344262363,0.0194848302886,0.0219448905169,0.0219448905169,0.0219448905169,0.0219448905169,0.0196284329097,0.0196284329097,0.0196284329097,0.0196284329097,0.0196284329097,0.0196284329097,0.0194848302886,0.0192344262363,0.0192344262363,0.0192344262363,0.0192344262363,0.0192344262363,0.0219448905169,0.0194848302886,0.0196284329097,0.0196284329097,0.0151683152843,0.0151683152843,0.0204865142465,0.0250689156412,0.0250689156412,0.0250689156412,0.024061601249,0.0226800634534,0.027078483582,0.027078483582,0.027078483582,0.0260793483735,0.027078483582,0.027078483582,0.027078483582,0.0257163968511,0.0252366514866,0.0250689156412,0.0250689156412,0.0237011666727,0.0224314432878,0.0224314432878)
L_hpd_M95=c(0.411149738785, 0.411149738785,0.0870049533266,0.0819630715353,0.0801860161617,0.0724763942495,0.0712914445025,0.0696634581388,0.0685136090301,0.0683989790906,0.0683989790906,0.0683292738946,0.0683292738946,0.0682504653111,0.0682504653111,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0673889996132,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0674115560229,0.0673889996132,0.0673327063072,0.0674115560229,0.0674115560229,0.0674115560229,0.0673327063072,0.0674115560229,0.0673889996132,0.0673327063072,0.0673889996132,0.0673889996132,0.0673889996132,0.0673889996132,0.0673889996132,0.0668272599581,0.0668272599581,0.0673889996132,0.0673889996132,0.0673327063072,0.0673889996132,0.0673889996132,0.0673889996132,0.0681869046623,0.0681869046623,0.0682504653111,0.0683292738946,0.0683989790906,0.0683989790906,0.0683989790906,0.0685136090301,0.067326620986,0.067326620986,0.0673889996132,0.0685136090301,0.067326620986,0.0693727349105,0.0693727349105,0.0693727349105,0.0683292738946,0.0672352699516,0.067326620986,0.0682504653111,0.0683292738946,0.0660495368598,0.0663529051621,0.0663529051621,0.0663529051621,0.0663529051621,0.0663529051621,0.0668262955333,0.0693727349105,0.0694808311105,0.0694808311105,0.0694808311105,0.0672352699516,0.0672352699516,0.0672352699516,0.0672352699516,0.067326620986,0.067326620986,0.067326620986,0.067326620986,0.067326620986,0.067326620986,0.067326620986,0.067326620986,0.0704741101148,0.0683292738946,0.0694808311105,0.0724763942495,0.0752203918149,0.0862120744979,0.111881673451,0.12264555766,0.12333646266,0.12333646266,0.12333646266,0.12333646266,0.129008754086,0.129102832465,0.129102832465,0.128550444252,0.129102832465,0.129102832465,0.129008754086,0.128299404134,0.128299404134,0.128550444252,0.129102832465,0.129102832465,0.129102832465,0.134372099325)
M_hpd_m95=c(0.0231983312831, 0.0231983312831,0.0231983312831,0.0231983312831,0.0233064277837,0.0233064277837,0.0230297984471,0.0230297984471,0.0230297984471,0.022955192408,0.022955192408,0.022955192408,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0230297984471,0.0233064277837,0.0233064277837,0.0233064277837,0.0233064277837,0.0233064277837,0.0233064277837,0.022955192408,0.022955192408,0.022955192408,0.022955192408,0.0230297984471,0.0232585322291,0.0232585322291,0.0223145099997,0.0223145099997,0.0223145099997,0.0223145099997,0.0232585322291,0.0232585322291,0.0225045790566,0.0232585322291,0.0225045790566,0.0225281333579,0.0225281333579,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0219658969005,0.0224231495873,0.0219658969005,0.0223145099997,0.0223145099997,0.0223145099997,0.0223145099997,0.0223145099997,0.0194569045661,0.0196134948592,0.0194569045661,0.0191377517462,0.0189524654862,0.0200294274106,0.0192672780363,0.0182197279113,0.0182197279113,0.0182197279113,0.0182197279113,0.0175649891508,0.0175649891508,0.0151525840787,0.0142291644933,0.0135651326734,0.0132821663257,0.0130428051271,0.0128932801298,0.012752475311,0.0126323694537,0.0122475107147,0.0121007268872,0.0120707733875,0.0120707733875,0.0120707733875,0.0120707733875,0.0120707733875,0.0120707733875,0.0120707733875,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039,0.01189096039)
M_hpd_M95=c(0.0563826952313, 0.0563826952313,0.0563826952313,0.0563826952313,0.0563826952313,0.0563826952313,0.0560565428007,0.0560565428007,0.0560565428007,0.0559220586881,0.0559220586881,0.0559220586881,0.0559220586881,0.0559220586881,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0560565428007,0.0563826952313,0.0563826952313,0.0563826952313,0.0563826952313,0.0563826952313,0.0563826952313,0.0559220586881,0.0559220586881,0.0559220586881,0.0559220586881,0.0559220586881,0.0560565428007,0.0560565428007,0.0551717754114,0.0551717754114,0.0550927760701,0.0551717754114,0.0563826952313,0.0563826952313,0.0556815921385,0.0563826952313,0.0556815921385,0.0557273316438,0.0557273316438,0.0550927760701,0.0550927760701,0.0551717754114,0.0551717754114,0.0550927760701,0.0551717754114,0.0551717754114,0.0551717754114,0.0551717754114,0.0551717754114,0.0551717754114,0.0551717754114,0.0557273316438,0.0551717754114,0.0557273316438,0.0559015561492,0.0560565428007,0.0563826952313,0.0568817185441,0.0546890597012,0.0546890597012,0.0546890597012,0.0546887877259,0.0549323719081,0.0564429988821,0.0557273316438,0.0548705381021,0.0546887877259,0.0546887877259,0.0548705381021,0.0545338993218,0.0545338993218,0.0527712974664,0.051940055872,0.0519219927307,0.051940055872,0.0519168774559,0.051940055872,0.051940055872,0.051940055872,0.0519168774559,0.051940055872,0.051940055872,0.051940055872,0.051940055872,0.051940055872,0.051940055872,0.051940055872,0.051940055872,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559,0.0519168774559)
R_hpd_m95=c(-0.0290976771964, -0.0290976771964,-0.0268445062667,-0.0268445062667,-0.0228811408731,-0.0171803848423,-0.0159864447006,-0.0156766281252,-0.0166540495108,-0.0166540495108,-0.0166540495108,-0.0166540495108,-0.0165948008498,-0.0164929732933,-0.0164542373891,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0166540495108,-0.0164542373891,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0153197458089,-0.0157963531595,-0.0153197458089,-0.0153197458089,-0.0153197458089,-0.0153197458089,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0157963531595,-0.0164542373891,-0.0166540495108,-0.0165948008498,-0.0166540495108,-0.0165948008498,-0.0166540495108,-0.0166540495108,-0.0165948008498,-0.0166540495108,-0.0165948008498,-0.0166540495108,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0171803848423,-0.0176518742731,-0.0181737463434,-0.0184408076487,-0.0184408076487,-0.0189024946216,-0.0166540495108,-0.0166540495108,-0.0168660903531,-0.0170995134356,-0.0166540495108,-0.0188236169111,-0.0180586316926,-0.0184408076487,-0.018497236543,-0.018497236543,-0.018497236543,-0.018497236543,-0.0184408076487,-0.0189024946216,-0.019278994803,-0.0194005030018,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0176518742731,-0.0171803848423,-0.0176518742731,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168041891888,-0.0166540495108,-0.0168041891888,-0.0168660903531,-0.0194005030018,-0.0208054210028,-0.0248853644828,-0.0194005030018,-0.019278994803,-0.0194005030018,-0.0194005030018,-0.0219271235937,-0.0168660903531,-0.0175822099086,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.0175822099086,-0.0168660903531,-0.0168660903531,-0.0168660903531,-0.019278994803,-0.0168660903531,-0.0175822099086,-0.0168660903531,-0.0162323427585)
R_hpd_M95=c(0.388599949873, 0.388599949873,0.0657438042086,0.0457841346241,0.045214054383,0.0424091733875,0.0398056887527,0.0389598584234,0.0358729076885,0.0358729076885,0.0357355932513,0.0357355932513,0.0355299745645,0.0355299745645,0.0355299745645,0.0361662738472,0.0361662738472,0.0361662738472,0.0351142083659,0.0351747307242,0.0357355932513,0.0356576754203,0.0356576754203,0.0356576754203,0.0357355932513,0.0357355932513,0.0357355932513,0.0357355932513,0.0357355932513,0.0357355932513,0.0357355932513,0.0356576754203,0.0356576754203,0.0356576754203,0.0356576754203,0.0361662738472,0.0356576754203,0.0358729076885,0.0358729076885,0.0361662738472,0.0361662738472,0.0356576754203,0.0357355932513,0.0357355932513,0.0358729076885,0.0358729076885,0.0353306375637,0.0352493497343,0.0355299745645,0.0353306375637,0.0355299745645,0.0355299745645,0.0352493497343,0.0355299745645,0.0353306375637,0.0355299745645,0.0356576754203,0.0356576754203,0.0357355932513,0.0356576754203,0.0357355932513,0.0357355932513,0.0358729076885,0.0357355932513,0.0357355932513,0.0358729076885,0.0358729076885,0.0387372051895,0.0387372051895,0.0392257572301,0.0398056887527,0.040943947347,0.0398056887527,0.040943947347,0.0409990818546,0.0409990818546,0.0409990818546,0.0409990818546,0.0409990818546,0.0409990818546,0.0408421203387,0.0409990818546,0.0414665981718,0.0431202372258,0.0429365550215,0.0429365550215,0.0430314907347,0.0431202372258,0.0435112984291,0.0435112984291,0.0436444652431,0.0435112984291,0.044696575176,0.044696575176,0.044696575176,0.0445737291393,0.0448587748859,0.0448587748859,0.0448587748859,0.046645983612,0.0468678877293,0.0501054568742,0.0551641033389,0.0763674414315,0.0827251465503,0.0864075978231,0.0869601473937,0.0869601473937,0.0932898095698,0.0938139534984,0.0950435305812,0.0950435305812,0.0953279637297,0.0950435305812,0.0938139534984,0.0938139534984,0.0953279637297,0.0964925129637,0.0955712033676,0.100393836827,0.101583340768,0.103622692251,0.108212103872)
L_mean=c(0.0956804585943, 0.0956804585943,0.0594960872668,0.0561796436278,0.0556806228495,0.0524858360718,0.050704256822,0.0501842495858,0.0495315124952,0.0495215392078,0.0494192487751,0.0494005505751,0.0493733915274,0.0492910877603,0.0492910877603,0.0492671827899,0.0492201577997,0.0492201577997,0.0491161301412,0.0491051957842,0.0490844320023,0.0490640674393,0.0490703789173,0.0490655251892,0.0490664247096,0.0490679362013,0.0490525597507,0.0490591100538,0.049046147343,0.0490414722752,0.0490464649053,0.0490275416406,0.0490248385788,0.0490070753329,0.0490695191688,0.0491024551223,0.0491443824963,0.0491758707969,0.0493380812954,0.0493454588487,0.0493369853229,0.0492734333672,0.0492703052239,0.049257333815,0.0492726216122,0.0492482182706,0.0492370010876,0.0491664521317,0.0490844656543,0.0488760432076,0.0487816504354,0.048631293193,0.048458188849,0.04839530984,0.0483029031412,0.0482339793422,0.0481589142547,0.0481108782904,0.0480599806831,0.0479743522459,0.0479479373477,0.0479088306217,0.047850418317,0.0477672682111,0.0476610691605,0.0475678142839,0.0474592443056,0.0473633758828,0.0473382334798,0.0471002785071,0.0469593396393,0.0466442678721,0.0465111577321,0.0463876985988,0.0462828284561,0.0462522411701,0.0462268402969,0.0461966739452,0.0461727236057,0.0461640088981,0.0461597354813,0.0461402399154,0.0461224239589,0.046107450767,0.0461017301776,0.0460799699734,0.046071197882,0.046055547266,0.0460717747737,0.0461147063543,0.0461151727529,0.0461387795413,0.0461438076374,0.0461465454375,0.0461604323082,0.0462050888199,0.0463747923242,0.0464764988277,0.0466470001539,0.0471403179667,0.048128777965,0.0498642481239,0.0519571473988,0.0537289782722,0.0548975575597,0.0553061285741,0.0555157992983,0.0556921725814,0.0558394984678,0.0560538593479,0.0561064188655,0.0560985117376,0.0562538536829,0.0562047454541,0.0562352847634,0.056205076633,0.0564017788474,0.0565688002418,0.0567198095202,0.0569097966032,0.0571740672939,0.0574648022503,0.0580254505292)
M_mean=c(0.0386580757573, 0.0386580757573,0.0386580757573,0.0386580757573,0.0383739746268,0.0383662333825,0.0383327476067,0.0383327476067,0.038336164393,0.0383221578974,0.0383221578974,0.0383176607346,0.038306185892,0.038306185892,0.0382934683065,0.0382934683065,0.0382970846247,0.0382970846247,0.0383003485847,0.0383003485847,0.0383063356354,0.0383063356354,0.0383036280783,0.0382999878588,0.038318792036,0.038318792036,0.0383120792512,0.0382932364809,0.0382949617303,0.0382972694803,0.0382903260069,0.0382871156641,0.0382871156641,0.0382775444397,0.038268787085,0.0382556890894,0.0382556647759,0.038249754262,0.0382390564069,0.0382148439507,0.0381858089989,0.0381644451313,0.0381377736718,0.0381410283804,0.03811581704,0.0380987490984,0.0380855298254,0.0380505009741,0.0380178727584,0.0379859641051,0.0379322680676,0.0378999280589,0.0378811756898,0.037875843915,0.037855271814,0.0378360201279,0.0378277981655,0.0378138820284,0.0378020122117,0.037805464289,0.0377872205046,0.0377872456549,0.0377341498835,0.037728223559,0.0376509439229,0.0374254059634,0.0372065953817,0.0370646901857,0.0369581609168,0.0368596717294,0.0367101042352,0.0365613544666,0.0364861535818,0.0364022174499,0.0362784529711,0.0361980445597,0.0361841108238,0.036117556119,0.0360334181848,0.0358868839911,0.0356648700978,0.0354937679789,0.0351257801221,0.0347303421067,0.0345530035751,0.034345711409,0.0341833358693,0.034100498377,0.0339220826139,0.033866128602,0.0338204823072,0.0338104520181,0.0337977810769,0.0337977810769,0.0337977810769,0.0337837845071,0.0337837845071,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337702449561,0.0337620529459,0.0337620529459,0.0337620529459,0.0337620529459,0.0337620529459,0.0337620529459,0.0337620529459)
R_mean=c(0.057022382837, 0.057022382837,0.0208380115095,0.0175215678706,0.0173066482227,0.0141196026893,0.0123715092152,0.011851501979,0.0111953481021,0.0111993813104,0.0110970908777,0.0110828898405,0.0110672056354,0.0109849018682,0.0109976194538,0.0109737144834,0.010923073175,0.010923073175,0.0108157815565,0.0108048471995,0.0107780963669,0.0107577318038,0.010766750839,0.0107655373305,0.0107476326736,0.0107491441653,0.0107404804996,0.010765873573,0.0107511856127,0.010744202795,0.0107561388984,0.0107404259765,0.0107377229147,0.0107295308932,0.0108007320838,0.0108467660329,0.0108887177204,0.0109261165349,0.0110990248885,0.0111306148981,0.011151176324,0.0111089882359,0.0111325315521,0.0111163054346,0.0111568045723,0.0111494691722,0.0111514712621,0.0111159511577,0.0110665928959,0.0108900791024,0.0108493823678,0.0107313651341,0.0105770131592,0.010519465925,0.0104476313273,0.0103979592143,0.0103311160893,0.0102969962621,0.0102579684715,0.0101688879569,0.0101607168431,0.0101215849668,0.0101162684335,0.0100390446521,0.0100101252377,0.0101424083204,0.0102526489238,0.0102986856972,0.010380072563,0.0102406067777,0.0102492354041,0.0100829134055,0.0100250041504,0.00998548114898,0.010004375485,0.0100541966104,0.010042729473,0.0100791178262,0.0101393054209,0.010277124907,0.0104948653835,0.0106464719365,0.0109966438368,0.0113771086603,0.0115487266025,0.0117342585644,0.0118878620126,0.0119550488891,0.0121496921598,0.0122485777523,0.0122946904457,0.0123283275232,0.0123460265604,0.0123487643606,0.0123626512312,0.0124213043128,0.0125910078171,0.0127062538717,0.0128767551978,0.0133700730107,0.0143585330089,0.0160940031678,0.0181869024428,0.0199587333161,0.0211273126036,0.021535883618,0.0217455543423,0.0219219276253,0.0220692535117,0.0222836143918,0.0223361739095,0.0223282667816,0.0224836087268,0.022434500498,0.0224650398073,0.0224348316769,0.0226397259015,0.0228067472958,0.0229577565743,0.0231477436573,0.023412014348,0.0237027493043,0.0242633975832)
trans=0.5
age=(0:(123-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.452264712664), xlim = c(-129.15,6.15), ylab = 'Speciation rate', xlab = 'Ma',main='pyrate' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.0625698903985), xlim = c(-129.15,6.15), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.0320074449161, 0.42745994486), xlim = c(-129.15,6.15), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-129.15,6.15), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()